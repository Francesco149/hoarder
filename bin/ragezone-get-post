#!/bin/sh

case "$1" in
  http://*.ragezone.com/*/*-post*)
    id=$(echo "$1" | sed -n 's/^.*-post\([0-9]\+\).*$/\1/p') ;;
  *)
    if ! id=$(echo "$1" | grep '^[0-9]\+$'); then
      echo
      echo "gets the bbcode for a post on ragezone. note: output is wrapped in a xml node"
      echo "usage: $0 post"
      echo
      echo "  post: either a link to the specific post, such as"
      echo "        http://forum.ragezone.com/f420/some-post-123-post123/#post123"
      echo "        or the post id (123 in this example)"
      echo
      exit 1
    fi
    ;;
esac

curl "http://forum.ragezone.com/ajax.php?do=getquotes&p=${id}" \
  --form do=getquotes --form p="${id}" --compressed --insecure
